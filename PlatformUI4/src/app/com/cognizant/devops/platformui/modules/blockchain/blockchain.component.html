<!--
 *********************************************************************************
 * Copyright 2019 Cognizant Technology Solutions
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License.  You may obtain a copy
 * of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 *******************************************************************************
-->
<div class="cardCssAudit">
  <div layout layout-align="left" class="titleStyle">
    <div> <span>Audit Reporting </span>
    </div>
  </div>
  <div class="searchBorder">
    <mat-radio-group [(ngModel)]="selectedOption">
      <mat-radio-button value="searchByDates" class="radioButtonChanges" (change)="searchCriteriaChange($event)">
        <div class="field-category" [style.width.%]="30">
          <span class="select-label">Start Date (MM/DD/YYYY)</span>
          <mat-form-field appearance="fill" class="formfield-custom">
            <input matInput #startDateMatInput [matDatepicker]="startDatePicker" required [max]="today"
              (dateChange)="getStartDate($event)" placeholder="Start Date (MM/DD/YYYY)" disabled>
            <mat-datepicker-toggle matSuffix [for]="startDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #startDatePicker startView="month" [startAt]="startDate" [disabled]="false">
            </mat-datepicker>
          </mat-form-field>
        </div>

        <div class="field-category" [style.width.%]="30">
          <span class="select-label">End Date (MM/DD/YYYY)</span>
          <mat-form-field appearance="fill" class="formfield-custom">
            <input matInput #endDateMatInput [matDatepicker]="endDatePicker" required [max]="today"
              (dateChange)="getEndDate($event)" placeholder="End Date (MM/DD/YYYY)" disabled>
            <mat-datepicker-toggle matSuffix [for]="endDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #endDatePicker [disabled]="false"></mat-datepicker>
          </mat-form-field>
        </div>

        <div class="field-category" [style.width.%]="30">
          <span class="select-label">Tool</span>
          <mat-form-field appearance="fill" class="formfield-custom">
            <mat-select required name="toolname" [(ngModel)]="toolname" placeholder="Issue Type">
              <mat-option *ngFor="let tl of tools " value="{{tl}}" class="optionsBckgnd">
                {{tl}}</mat-option>
            </mat-select>
            <mat-icon matSuffix svgIcon="arrow-down" class="arrow-icon"
              style="width: 12px !important; height: 12px !important;"></mat-icon>
          </mat-form-field>
        </div>
      </mat-radio-button>
      
      <mat-radio-button value="searchByAssetId" class="radioButtonChanges" (change)="searchCriteriaChange($event)"
        [style.width.%]="100">
        <div [style.width.%]="30" class="field-category">
          <span class="select-label">Input Asset ID</span>
          <mat-form-field appearance="fill" class="formfield-custom">
            <input matInput #assetIdInput type="text" (click)="getAssetID(assetIdInput.value)"
              (keyup.enter)="getAssetID(assetIdInput.value)" (blur)="getAssetID(assetIdInput.value)"
              placeholder="Search for an Asset">
          </mat-form-field>
        </div>
        <div [style.width.%]="7" class="field-category">
          <span class="select-label"></span>
          <button (click)="searchAllAssets()" class="button-save button-save-dimensions">
            Search
          </button>
        </div>
        <div [style.width.%]="7" class="field-category">
          <span class="select-label"></span>
          <button (click)="clear()" class="button-cancel button-cancel-dimensions">
            Clear
          </button>
        </div>
      </mat-radio-button>
    </mat-radio-group>
  </div>

  <div class="scrollDiv" [hidden]="!showSearchResult">
    <div class="rowContainer">
      <div class="leftAlignStyle">
        <input matInput (keyup)="applyAssetFilter($event.target.value)" placeholder="Search for an Asset"
          class="inputColCss">
        <button (keyup)="applyAssetFilter($event.target.value)" class="searchCss">
          <mat-icon title="Search" svgIcon="searchIcon">
          </mat-icon>
        </button>
      </div>
    </div>

    <table mat-table [dataSource]="dataSource" multiTemplateDataRows matSort>

      <!-- Radio Button Column -->
      <ng-container matColumnDef="select">
        <th mat-header-cell *matHeaderCellDef class="tableHeader">
        </th>
        <td mat-cell *matCellDef="let row;let i = dataIndex" style="width:40px !important;text-align: left">
          <mat-radio-button value="{{row.assetID}}" (change)="populateBasePrimeID($event, row.assetID,i)">
          </mat-radio-button>
        </td>
      </ng-container>

      <!-- Asset ID Column -->
      <ng-container matColumnDef="assetID">
        <th mat-header-cell *matHeaderCellDef class="tableHeader" mat-sort-header> Asset ID </th>
        <td mat-cell *matCellDef="let element"> {{element.assetID}} </td>
      </ng-container>

      <!-- Tool Name Column -->
      <ng-container matColumnDef="toolName">
        <th mat-header-cell *matHeaderCellDef class="tableHeader" mat-sort-header> Tool Name </th>
        <td mat-cell *matCellDef="let element"> {{element.toolName}} </td>
      </ng-container>

      <!-- Phase Column -->
      <ng-container matColumnDef="phase">
        <th mat-header-cell *matHeaderCellDef class="tableHeader" mat-sort-header> Phase </th>
        <td mat-cell *matCellDef="let element"> {{element.phase}} </td>
      </ng-container>

      <!-- Status Column -->
      <ng-container matColumnDef="toolstatus">
        <th mat-header-cell *matHeaderCellDef class="tableHeader" mat-sort-header> Status </th>
        <td mat-cell *matCellDef="let element"> {{element.toolstatus}} </td>
      </ng-container>

      <!-- Status Column -->
      <ng-container matColumnDef="timestamp">
        <th mat-header-cell *matHeaderCellDef class="tableHeader" mat-sort-header> Last Updated Time </th>
        <td mat-cell *matCellDef="let element"> {{element.timestamp}} </td>
      </ng-container>

      <ng-container matColumnDef="details">
        <th mat-header-cell *matHeaderCellDef class="tableHeader"> Details
        </th>
        <td mat-cell *matCellDef="let element;let i=dataIndex">
          <button mat-icon-button [disabled]="(selectedIndex != i + currentPageIndex)"
            (click)="showAssetDetailsDialog()">
            <mat-icon svgIcon="active_show_details" [disabled]="(selectedIndex != i + currentPageIndex)"
              [ngStyle]="{height: '35px', width: '35px'}" matTooltip="Show Details" matTooltipPosition="above">
            </mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns" class="tableHeader"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;">
      </tr>
    </table>

    <div class="footer">
      <div class="paginator">
        <mat-paginator style="visibility: hidden;" #paginator [pageSize]="MAX_ROWS_PER_TABLE">
        </mat-paginator>
        <div class="paginatorElement" (click)="goToPrevPage()" [attr.disabled]="!this.paginator.hasPreviousPage()"
          [ngStyle]="!this.paginator.hasPreviousPage() ? {'cursor': 'not-allowed'} : ''">
          <mat-icon svgIcon="prev-page" class="pageIcons" style="cursor: pointer"
            *ngIf="this.paginator.hasPreviousPage()" style="height: 24px !important; width: 24px !important;">
          </mat-icon>
          <mat-icon svgIcon="prev-page" class="pageIcons disabled-icon" *ngIf="!this.paginator.hasPreviousPage()"
            style="height: 24px !important; width: 24px !important;">
          </mat-icon>
        </div>
        <div class="paginatorElement paginatorIndexElement">{{currentPageIndex}}</div>
        <div class="paginatorElement" (click)="goToNextPage()" [attr.disabled]="!this.paginator.hasNextPage()"
          [ngStyle]="!this.paginator.hasNextPage() ? {'cursor': 'not-allowed'} : ''">
          <mat-icon svgIcon="next-page" style="cursor: pointer" class="pageIcons" *ngIf="this.paginator.hasNextPage()"
            style="height: 24px !important; width: 24px !important;">
          </mat-icon>
          <mat-icon svgIcon="next-page" class="pageIcons disabled-icon" *ngIf="!this.paginator.hasNextPage()"
            style="height: 24px !important; width: 24px !important;">
          </mat-icon>
        </div>
        <div>
          of {{totalPages}}
        </div>
      </div>
    </div>
  </div>

</div>